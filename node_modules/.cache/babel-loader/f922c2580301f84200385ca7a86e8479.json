{"ast":null,"code":"var _jsxFileName = \"/home/abdel/Desktop/parking-reservation-front-react/src/components/ParkingCalendar.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport Calendar from 'react-calendar';\nimport IconButton from '@material-ui/core/IconButton';\nimport { AiFillBackward as ArrowBackIcon } from \"react-icons/ai\";\nimport { GiConfirmed as DoneOutlineIcon } from \"react-icons/gi\";\nimport { AiFillWarning as GiInterdiction } from \"react-icons/ai\";\nimport 'react-calendar/dist/Calendar.css';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { isWithinInterval } from \"date-fns\";\nimport { useStore } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport { saveParkingReservation } from \"../actions/parkingReservationActions\";\nimport axios from 'axios';\nimport authHeader from \"../securityUtils/authorisationHeader\";\nimport SERVER_URL from '../securityUtils/path';\nimport formatDate from \"../util/formatDate\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction isWithinRange(date, range) {\n  return isWithinInterval(date, {\n    start: range[0],\n    end: range[1]\n  });\n}\n\nfunction isWithinRanges(date, ranges) {\n  return ranges.some(range => isWithinRange(date, range));\n}\n\nfunction checkFirstDate(date, ranges) {\n  return ranges.some(range => {\n    return sameDate(date, range[0]);\n  });\n}\n\nfunction sameDate(dat1, dat2) {\n  return dat1.getDate() === dat2.getDate() && dat1.getFullYear() === dat2.getFullYear() && dat1.getMonth() === dat2.getMonth();\n}\n\nfunction rangeIntersection(selectedrange, disabledRange) {\n  return selectedrange[0] < disabledRange[0] && selectedrange[1] > disabledRange[1];\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: 'red',\n    padding: 10,\n    maeginBottom: 10,\n    textAlign: 'center'\n  },\n  validateButton: {\n    marginBottom: 5,\n    marginRight: 5\n  }\n}));\n\nconst ParkingCalendar = ({\n  park\n}) => {\n  _s();\n\n  const classes = useStyles();\n  const store = useStore();\n  const history = useHistory();\n  const [dateValue, setDateValue] = useState([]);\n  const [datesSelected, setDatesSelected] = useState(false);\n  const [disabledRanges, setDisabledRanges] = useState([]);\n  const [errorRange, setErrorRange] = useState(false);\n\n  function back() {\n    setDatesSelected(false);\n  }\n\n  function tileDisabled({\n    date,\n    view\n  }) {\n    if (view === 'month') {\n      return isWithinRanges(date, disabledRanges) || checkFirstDate(date, disabledRanges);\n    }\n  }\n\n  function dateSelected(e) {\n    const selectedRane = [new Date(e[0]), new Date(e[1])];\n    if (disabledRanges.some(range => rangeIntersection(selectedRane, range))) setErrorRange(true);else {\n      setDateValue(selectedRane);\n      setDatesSelected(true);\n    }\n  }\n\n  function book() {\n    const parkReservation = {\n      park: park,\n      start_reservation: formatDate(dateValue[0]),\n      end_reservation: formatDate(dateValue[1])\n    };\n    store.dispatch(saveParkingReservation(parkReservation, history));\n  }\n\n  useEffect(() => {\n    async function fetch() {\n      await axios.get(`${SERVER_URL}/api/parking/${park}`, {\n        \"Authorisation\": authHeader\n      }).then(response => {\n        const ranges = response.data.map(res => {\n          const range = [new Date(res.startDate), new Date(res.endDate)];\n          return range;\n        });\n        setDisabledRanges(ranges);\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n\n    fetch();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: datesSelected ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: classes.root,\n        children: \"\\u062A\\u0641\\u0627\\u0635\\u064A\\u0644\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \": \\u0644\\u0642\\u062F \\u0627\\u062E\\u062A\\u0631\\u062A \\u0627\\u0644\\u062D\\u062C\\u0632\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: showDatesRange(dateValue)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          marginTop: 15\n        },\n        children: [/*#__PURE__*/_jsxDEV(IconButton, {\n          onClick: back,\n          variant: \"contained\",\n          color: \"primary\",\n          disableElevation: true,\n          children: /*#__PURE__*/_jsxDEV(ArrowBackIcon, {\n            color: \"red\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(IconButton //onClick={book}\n        , {\n          variant: \"contained\",\n          color: \"primary\",\n          disableElevation: true,\n          className: classes.validateButton,\n          children: /*#__PURE__*/_jsxDEV(DoneOutlineIcon, {\n            color: \"green\",\n            onClick: book\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 21\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Calendar, {\n        onChange: dateSelected,\n        tileDisabled: tileDisabled,\n        minDate: new Date(Date.now()) //value={dateValue}\n        ,\n        view: \"month\",\n        selectRange: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 25\n      }, this), errorRange && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: \"red\",\n          fontSize: 16,\n          fontWeight: 'bold',\n          dmarginTop: 20,\n          display: \"flex\",\n          justifyContent: \"center\",\n          marginTop: 15\n        },\n        dir: \"rtl\",\n        children: [\"\\u0644\\u0627 \\u064A\\u0645\\u0643\\u0646! \", /*#__PURE__*/_jsxDEV(GiInterdiction, {\n          color: \"red\",\n          onClick: book,\n          variant: \"contained\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 43\n        }, this), \" \\u0627\\u062E\\u062A\\u0627\\u0631 \\u062A\\u0627\\u0631\\u064A\\u062E\\u0627 \\u0627\\u062E\\u0631\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 29\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 21\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ParkingCalendar, \"Vg6LRuXfEjQLKdx68m340cUvUgQ=\", false, function () {\n  return [useStyles, useStore, useHistory];\n});\n\n_c = ParkingCalendar;\nexport default ParkingCalendar;\n\nfunction showDatesRange(dates) {\n  return `من ${dates[0].getDate()}-${dates[0].getMonth() + 1}-${dates[0].getFullYear()} الى \n     ${dates[1].getDate()}-${dates[1].getMonth() + 1}-${dates[1].getFullYear()}\n    `;\n}\n\nfunction formatDateV2(dateValue) {\n  return `${dateValue.getFullYear()}-${dateValue.getMonth() + 1}-${dateValue.getDate()}`;\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"ParkingCalendar\");","map":{"version":3,"sources":["/home/abdel/Desktop/parking-reservation-front-react/src/components/ParkingCalendar.js"],"names":["React","useEffect","useState","Calendar","IconButton","AiFillBackward","ArrowBackIcon","GiConfirmed","DoneOutlineIcon","AiFillWarning","GiInterdiction","makeStyles","isWithinInterval","useStore","useHistory","saveParkingReservation","axios","authHeader","SERVER_URL","formatDate","isWithinRange","date","range","start","end","isWithinRanges","ranges","some","checkFirstDate","sameDate","dat1","dat2","getDate","getFullYear","getMonth","rangeIntersection","selectedrange","disabledRange","useStyles","theme","root","fontSize","fontWeight","color","padding","maeginBottom","textAlign","validateButton","marginBottom","marginRight","ParkingCalendar","park","classes","store","history","dateValue","setDateValue","datesSelected","setDatesSelected","disabledRanges","setDisabledRanges","errorRange","setErrorRange","back","tileDisabled","view","dateSelected","e","selectedRane","Date","book","parkReservation","start_reservation","end_reservation","dispatch","fetch","get","then","response","data","map","res","startDate","endDate","catch","error","console","log","showDatesRange","display","justifyContent","marginTop","now","dmarginTop","dates","formatDateV2"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Calendar from 'react-calendar';\nimport IconButton from '@material-ui/core/IconButton';\nimport { AiFillBackward as ArrowBackIcon } from \"react-icons/ai\";\nimport { GiConfirmed as DoneOutlineIcon } from \"react-icons/gi\";\nimport { AiFillWarning as GiInterdiction } from \"react-icons/ai\";\nimport 'react-calendar/dist/Calendar.css';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { isWithinInterval } from \"date-fns\";\nimport { useStore } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport { saveParkingReservation } from \"../actions/parkingReservationActions\";\nimport axios from 'axios';\nimport authHeader from \"../securityUtils/authorisationHeader\"\nimport SERVER_URL from '../securityUtils/path';\nimport formatDate from \"../util/formatDate\";\n\n\nfunction isWithinRange(date, range) {\n    return isWithinInterval(date, { start: range[0], end: range[1] });\n}\nfunction isWithinRanges(date, ranges) {\n    return ranges.some(range => isWithinRange(date, range));\n}\nfunction checkFirstDate(date, ranges) {\n    return ranges.some(range => { return sameDate(date,range[0])});\n}\nfunction sameDate(dat1,dat2){\n    return dat1.getDate()===dat2.getDate()&& dat1.getFullYear()===dat2.getFullYear()&&dat1.getMonth()===dat2.getMonth()\n}\nfunction rangeIntersection(selectedrange, disabledRange) {\n    return selectedrange[0] < disabledRange[0] && selectedrange[1] > disabledRange[1];\n}\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        fontSize: 20,\n        fontWeight: 'bold',\n        color: 'red',\n        padding:10,\n        maeginBottom:10,\n        textAlign:'center'\n    },\n    validateButton:{\n        marginBottom:5,\n        marginRight:5\n      }\n}));\nconst ParkingCalendar = ({ park }) => {\n    const classes = useStyles();\n    const store = useStore();\n    const history = useHistory();\n    const [dateValue, setDateValue] = useState([]);\n    const [datesSelected, setDatesSelected] = useState(false);\n    const [disabledRanges, setDisabledRanges] = useState([]);\n    const [errorRange, setErrorRange] = useState(false);\n\n    function back() {\n        setDatesSelected(false);\n    }\n\n    function tileDisabled({ date, view }) {\n        if (view === 'month') {\n            return isWithinRanges(date, disabledRanges)||checkFirstDate(date, disabledRanges);\n        }\n    }\n\n    function dateSelected(e) {\n        const selectedRane = [new Date(e[0]), new Date(e[1])];\n        if (disabledRanges.some((range => rangeIntersection(selectedRane, range))))\n            setErrorRange(true);\n        else {\n            setDateValue(selectedRane);\n            setDatesSelected(true);\n        }\n    }\n\n    function book() {\n        const parkReservation = {\n            park: park,\n            start_reservation: formatDate(dateValue[0]),\n            end_reservation: formatDate(dateValue[1])\n        }\n        store.dispatch(saveParkingReservation(parkReservation, history));\n    }\n\n    useEffect( () => {\n        async function fetch(){\n            await axios.get(`${SERVER_URL}/api/parking/${park}`, { \"Authorisation\": authHeader })\n            .then(response => {\n                const ranges = response.data.map(res => {\n                    const range = [new Date(res.startDate), new Date(res.endDate)];\n                    return range;\n                });\n                setDisabledRanges(ranges);\n            })\n            .catch(error => {\n                console.log(error);\n            });\n        }\n        fetch();\n    }, []);\n        \n\n    return (\n        <div>\n            {\n                datesSelected ?\n                    <div style={{textAlign:'center'}}>\n                        <p className={classes.root}>تفاصيل</p>\n                        <h3>: لقد اخترت الحجز</h3>\n                        <h3>{showDatesRange(dateValue)}</h3>\n                        <div style={{ display: \"flex\", justifyContent: \"space-between\", marginTop: 15 }}>\n\n                            <IconButton\n                                onClick={back}\n                                variant=\"contained\"\n                                color=\"primary\"\n                                disableElevation\n                            >\n                                <ArrowBackIcon color=\"red\" />\n                            </IconButton>\n                            <IconButton\n                                //onClick={book}\n                                variant=\"contained\"\n                                color=\"primary\"\n                                disableElevation\n                                className={classes.validateButton}\n                            >\n                                <DoneOutlineIcon color=\"green\" onClick={book} />\n                            </IconButton>\n                        </div>\n                    </div> :\n                    <div>\n                        <Calendar\n                            onChange={dateSelected}\n                            tileDisabled={tileDisabled}\n                            minDate={new Date((Date.now()))}\n                            //value={dateValue}\n                            view=\"month\"\n                            selectRange\n                        >\n                        </Calendar>\n                        {errorRange &&\n                            <div style={{ color: \"red\", fontSize: 16, fontWeight: 'bold', dmarginTop: 20, display: \"flex\", justifyContent: \"center\", marginTop: 15 }} dir=\"rtl\">\n                                 لا يمكن! <GiInterdiction color=\"red\" onClick={book} variant=\"contained\" /> اختار تاريخا اخر  \n                    </div>\n                        }\n                    </div>\n            }\n\n        </div>\n    )\n}\nexport default ParkingCalendar;\n\nfunction showDatesRange(dates) {\n    return `من ${dates[0].getDate()}-${dates[0].getMonth() + 1}-${dates[0].getFullYear()} الى \n     ${dates[1].getDate()}-${dates[1].getMonth() + 1}-${dates[1].getFullYear()}\n    `\n}\nfunction formatDateV2(dateValue) {\n    return `${dateValue.getFullYear()}-${dateValue.getMonth() + 1}-${dateValue.getDate()}`\n}\n\n"]},"metadata":{},"sourceType":"module"}